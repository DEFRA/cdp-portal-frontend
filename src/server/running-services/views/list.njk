{% extends "layouts/page.njk" %}

{% block content %}

  {{ appPageHeading({
    caption: "Whats running where?",
    text: "Running Services"
  }) }}

  {% call appFilters({
    action: "/running-services",
    noJsButton: {
      text: "Search"
    },
    hiddenInputs: hiddenInputs
  }) %}
    {% call govukFieldset({
      legend: {
        text: "Search",
        classes: "govuk-fieldset__legend--l govuk-!-margin-bottom-2"
      }
    }) %}
      <p class="govuk-caption-m govuk-!-margin-bottom-3">
        Search and filter running microservices
      </p>

      <div class="app-filters">
        <div class="app-filters__item">
          {{ appAutocomplete({
            id: "filters-service",
            name: "service",
            classes: "app-autocomplete--small app-autocomplete--inline",
            label: {
              text: "Service name",
              classes: "govuk-label--s app-label--inline govuk-!-margin-bottom-1"
            },
            formGroup: {
              classes: "app-form-group--inline"
            },
            value: formValues.service,
            suggestions: serviceFilters,
            placeholder: "Search by service"
          }) }}
        </div>

        <div class="app-filters__item">
          {{ appAutocomplete({
            id: "filters-team",
            name: "team",
            classes: "app-autocomplete--small app-autocomplete--inline",
            label: {
              text: "Team",
              classes: "govuk-label--s app-label--inline govuk-!-margin-bottom-1"
            },
            formGroup: {
              classes: "app-form-group--inline"
            },
            value: formValues.team,
            suggestions: teamFilters,
            placeholder: "Search by team"
          }) }}
        </div>

        <div class="app-filters__item">
          {{ appAutocomplete({
            id: "filters-user",
            name: "user",
            classes: "app-autocomplete--inline",
            label: {
              text: "User",
              classes: "govuk-label--s app-label--inline govuk-!-margin-bottom-1"
            },
            formGroup: {
              classes: "app-form-group--inline"
            },
            value: formValues.user,
            suggestions: userFilters,
            placeholder: "Search by user"
          }) }}
        </div>

        <div class="app-filters__item">
          {{ appAutocomplete({
            id: "filters-status",
            name: "status",
            classes: "app-autocomplete--tiny app-autocomplete--inline",
            label: {
              text: "Status",
              classes: "govuk-label--s app-label--inline govuk-!-margin-bottom-1"
            },
            formGroup: {
              classes: "app-form-group--inline"
            },
            value: formValues.status,
            suggestions: statusFilters,
            placeholder: "Search by status"
          }) }}
        </div>

        <p class="govuk-body-m govuk-!-margin-bottom-0 app-filters__clear-all">
          <a href="/running-services"
             class="govuk-link govuk-link--text-colour"
             data-clear-all="clearFilters"
             data-js="app-filters-clear-all">
            Clear all
          </a>
        </p>
      </div>

    {% endcall %}
  {% endcall %}

  {% block xhrContent %}
    <div data-xhr="running-services">
      {{ appEntityTable(tableData) }}
    </div>
  {% endblock %}

{% endblock %}
