{% extends "layouts/page.njk" %}

{% from "govuk/components/button/macro.njk" import govukButton %}

{% block content %}

  {{ appPageHeading({
    caption: "Team",
    text: team.name
  }) }}

  <hr class="app-section-break app-section-break--slim">

  {% if userIsServiceOwner %}
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-full-from-desktop-wide">
        <ul class="govuk-list govuk-!-margin-0">
          <li>
            <a href="{{ routeLookup('teams/{teamId}/add-member', { params: { teamId: team.teamId } }) }}"
               class="app-link app-link--underline" data-testid="add-team-member">
              Add member to team
            </a>
          </li>
        </ul>
      </div>
    </div>
  {% endif %}

  <div class="govuk-grid-row app-grid-row--stretch">
    <div class="govuk-grid-column-one-half-from-desktop-wide govuk-grid-column--slim">
      {% call appPanel() %}
        <section>
          <h2 class="govuk-heading-l govuk-!-margin-bottom-2">About</h2>
          <p class="govuk-!-margin-bottom-2">
            Team information and the services, test-suites, templates and libraries they own
          </p>

          {{ govukSummaryList(summaryList) }}
        </section>
      {% endcall %}
    </div>

    <div class="govuk-grid-column-one-half-from-desktop-wide govuk-grid-column--slim">
      {% call appPanel() %}
        <section>
          <h2 class="govuk-heading-l govuk-!-margin-bottom-2">Members</h2>
          <p class="govuk-!-margin-bottom-0">
            Team member information
          </p>

          {% if teamUsersRows | length %}
            {{ govukTable({
              classes: "app-table app-table--inverse govuk-!-margin-bottom-4",
              attributes: { 'data-testid': 'user-details' },
              head: [
                { text: "Members (" + teamUsersRows | length + ")" },
                { text: "Actions", classes: "govuk-table__header--numeric" } if isServiceOwnerOrAdmin
              ],
              rows: teamUsersRows
            }) }}
          {% else %}
            <p class="govuk-!-margin-top-2" data-testid="user-details">
              This team has no members
            </p>
          {% endif %}
        </section>
      {% endcall %}
    </div>
  </div>

  <div class="govuk-grid-row app-grid-row--stretch govuk-!-margin-top-2 govuk-!-margin-bottom-6">
    <div class="govuk-grid-column-one-quarter-from-desktop-wide govuk-grid-column--slim">
      {% call appPanel() %}
        <section>
          <h2 class="govuk-heading-l govuk-!-margin-bottom-2">
            {{ "Service" | pluralise(teamServices.items | length) }}
          </h2>

          {% if services.items | length %}
            {{ appDetailedList(services) }}
          {% else %}
            <p>This team has no services

              {% if userIsServiceOwner %}
                <a href="{{ routeLookup('create') }}"
                   class="app-link app-link--underline">
                  Create a service
                </a>
              {% endif %}
            </p>
          {% endif %}
        </section>
      {% endcall %}
    </div>

    <div class="govuk-grid-column-one-quarter-from-desktop-wide govuk-grid-column--slim">
      {% call appPanel() %}
        <section>
          <h2 class="govuk-heading-l govuk-!-margin-bottom-2">
            {{ "Test-suite" | pluralise(teamTestSuites.items | length) }}
          </h2>

          {% if testSuites.items | length %}
            {{ appDetailedList(testSuites) }}
          {% else %}
            <p>This team has no test-suites

              {% if userIsServiceOwner %}
                <a href="{{ routeLookup('create') }}"
                   class="app-link app-link--underline">
                  Create a test-suite
                </a>
              {% endif %}
            </p>
          {% endif %}
        </section>
      {% endcall %}
    </div>

    <div class="govuk-grid-column-one-quarter-from-desktop-wide govuk-grid-column--slim">
      {% call appPanel() %}
        <section>
          <h2 class="govuk-heading-l govuk-!-margin-bottom-2">
            {{ "Template" | pluralise(templates.items | length) }}
          </h2>

          {% if templates.items | length %}
            {{ appDetailedList(templates) }}
          {% else %}
            <p>This team has no templates</p>
          {% endif %}
        </section>
      {% endcall %}
    </div>

    <div class="govuk-grid-column-one-quarter-from-desktop-wide govuk-grid-column--slim">
      {% call appPanel() %}
        <section>
          <h2 class="govuk-heading-l govuk-!-margin-bottom-2">
            {{ "Library" | pluralise(libraries.items | length) }}
          </h2>

          {% if libraries.items | length %}
            {{ appDetailedList(libraries) }}
          {% else %}
            <p>This team has no libraries</p>
          {% endif %}
        </section>
      {% endcall %}
    </div>
  </div>

{% endblock %}
